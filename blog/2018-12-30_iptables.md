# iptables 笔记
## 结构

![iptables总体](./iptables.png)

## 命令
显示列表：`iptables -t filter -L -n`      -t参数指定显示哪个链，默认filter链，加-v显示更详细信息，可看到哪张网卡流入流出
清空设置：`iptables -F`
阻止特定源ip（111.111.11.11）对目的ip（10.18.139.82）的8080端口访问：`iptables -I DOCKER -s 111.111.11.11 -d 10.18.139.82 -p TCP --dport 8080 -j DROP`
开放端口： `iptables -A INPUT -p tcp --dport 22 -j ACCEPT` -A表示添加一个记录
禁止端口： `iptables -A INPUT -p tcp --dport 8080 -j DROP`
删除规则：先使用 `iptables -L -n --line-number` 查看number，之后使用`iptables -D INPUT 3` 删除number号对应的规则
设置仅通过少部分端口规则时注意设置允许环回，否则内部程序之间互相访问会有问题：`iptables -A INPUT -i lo -j ACCEPT`、`iptables -A OUTPUT -o lo -j ACCEPT`，通过`iptables -L -n -v` 可看到设置成功